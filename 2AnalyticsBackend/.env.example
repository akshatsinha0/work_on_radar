# POCM Analytics Backend Environment Configuration
# Copy this file to .env and update with your actual values
# This file can be safely committed to version control

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
SPRING_PROFILES_ACTIVE=dev
SERVER_PORT=8085
APPLICATION_NAME=analytics-backend

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL Database
DB_HOST=localhost
DB_PORT=5432
DB_NAME=analytics
DB_USERNAME=analytics
DB_PASSWORD=your_database_password_here
DB_SCHEMA=public

# R2DBC Connection String (constructed from above values)
SPRING_R2DBC_URL=r2dbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
SPRING_R2DBC_USERNAME=${DB_USERNAME}
SPRING_R2DBC_PASSWORD=${DB_PASSWORD}

# JDBC Connection String (for Flyway migrations)
SPRING_DATASOURCE_URL=jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
SPRING_DATASOURCE_USERNAME=${DB_USERNAME}
SPRING_DATASOURCE_PASSWORD=${DB_PASSWORD}

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0
REDIS_TIMEOUT=2000
REDIS_SSL=false

SPRING_REDIS_HOST=${REDIS_HOST}
SPRING_REDIS_PORT=${REDIS_PORT}
SPRING_REDIS_PASSWORD=${REDIS_PASSWORD}
SPRING_REDIS_DATABASE=${REDIS_DATABASE}

# =============================================================================
# KAFKA CONFIGURATION
# =============================================================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_TOPIC_PREFIX=pocm.analytics
KAFKA_CONSUMER_GROUP_ID=analytics-service
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true

SPRING_KAFKA_BOOTSTRAP_SERVERS=${KAFKA_BOOTSTRAP_SERVERS}
SPRING_KAFKA_CONSUMER_GROUP_ID=${KAFKA_CONSUMER_GROUP_ID}

# =============================================================================
# CLICKHOUSE CONFIGURATION (Optional - for Analytics Queries)
# =============================================================================
CLICKHOUSE_ENABLED=false
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=8123
CLICKHOUSE_DATABASE=analytics
CLICKHOUSE_USERNAME=default
CLICKHOUSE_PASSWORD=
CLICKHOUSE_SSL=false

CLICKHOUSE_URL=jdbc:clickhouse://${CLICKHOUSE_HOST}:${CLICKHOUSE_PORT}/${CLICKHOUSE_DATABASE}

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# JWT Configuration
JWT_SECRET_BASE64=your_base64_encoded_jwt_secret_key_here_minimum_256_bits
JWT_ISSUER=pocm-analytics
JWT_AUDIENCE=pocm-services
JWT_EXPIRATION_SECONDS=3600

# API Keys (comma-separated for multiple keys)
API_KEYS=dev-key-1,dev-key-2,your-api-key-here

# OAuth2 Resource Server (if using external auth provider)
OAUTH2_RESOURCE_SERVER_JWT_ISSUER_URI=https://your-auth-provider.com
OAUTH2_RESOURCE_SERVER_JWT_JWK_SET_URI=https://your-auth-provider.com/.well-known/jwks.json

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_REDIS_KEY_PREFIX=rl:

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
CACHE_ENABLED=true
CACHE_TTL_SECONDS=300
CACHE_MAX_SIZE=10000
CACHE_KEY_PREFIX=analytics:

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Actuator Endpoints
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=always
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true

# Logging Configuration
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_COM_POCM_ANALYTICS=DEBUG
LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_R2DBC=DEBUG
LOGGING_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
LOGGING_PATTERN_FILE=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================
# Machine Learning Service
ML_SERVICE_ENABLED=false
ML_SERVICE_BASE_URL=http://localhost:8090
ML_SERVICE_API_KEY=your_ml_service_api_key_here
ML_SERVICE_TIMEOUT_SECONDS=30

# Notification Service
NOTIFICATION_SERVICE_ENABLED=false
NOTIFICATION_SERVICE_BASE_URL=http://localhost:8091
NOTIFICATION_SERVICE_API_KEY=your_notification_service_api_key_here

# Email Service (for compliance notifications)
EMAIL_SERVICE_ENABLED=false
EMAIL_SMTP_HOST=smtp.example.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USERNAME=your_email_username
EMAIL_SMTP_PASSWORD=your_email_password
EMAIL_FROM_ADDRESS=analytics@pocm.com

# =============================================================================
# COMPLIANCE & AUDIT
# =============================================================================
# GDPR Configuration
GDPR_ENABLED=true
GDPR_DATA_RETENTION_DAYS=2555
GDPR_ANONYMIZATION_ENABLED=true
GDPR_EXPORT_FORMAT=JSON

# HIPAA Configuration
HIPAA_ENABLED=true
HIPAA_AUDIT_LOG_ENABLED=true
HIPAA_ENCRYPTION_ENABLED=true
HIPAA_ACCESS_LOG_RETENTION_DAYS=2555

# Audit Trail
AUDIT_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_INCLUDE_REQUEST_BODY=false
AUDIT_INCLUDE_RESPONSE_BODY=false

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
# Connection Pool Settings
DB_CONNECTION_POOL_INITIAL_SIZE=5
DB_CONNECTION_POOL_MAX_SIZE=20
DB_CONNECTION_POOL_MIN_IDLE=5
DB_CONNECTION_POOL_MAX_IDLE=10
DB_CONNECTION_POOL_MAX_WAIT=30000

# JVM Settings (for Docker deployment)
JAVA_OPTS=-Xms512m -Xmx2g -XX:+UseG1GC -XX:MaxGCPauseMillis=200

# Thread Pool Settings
ASYNC_EXECUTOR_CORE_POOL_SIZE=10
ASYNC_EXECUTOR_MAX_POOL_SIZE=50
ASYNC_EXECUTOR_QUEUE_CAPACITY=1000

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
# Development Mode Settings
DEV_MODE_ENABLED=true
DEV_CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
DEV_SWAGGER_ENABLED=true
DEV_H2_CONSOLE_ENABLED=false

# Test Database (H2 for integration tests)
TEST_DB_URL=jdbc:h2:mem:testdb;MODE=PostgreSQL;DB_CLOSE_DELAY=-1
TEST_DB_USERNAME=sa
TEST_DB_PASSWORD=

# =============================================================================
# DOCKER & DEPLOYMENT
# =============================================================================
# Docker Compose Override
COMPOSE_PROJECT_NAME=pocm-analytics
COMPOSE_FILE=docker-compose.yml:docker-compose.override.yml

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_BATCH_PROCESSING_ENABLED=true
FEATURE_REAL_TIME_STREAMING_ENABLED=true
FEATURE_ML_PREDICTIONS_ENABLED=false
FEATURE_CLICKHOUSE_ANALYTICS_ENABLED=false
FEATURE_WEBSOCKET_STREAMING_ENABLED=true
FEATURE_COMPLIANCE_REPORTING_ENABLED=true

# =============================================================================
# ENVIRONMENT SPECIFIC OVERRIDES
# =============================================================================
# These can be overridden in environment-specific files:
# .env.local (for local development)
# .env.development (for development environment)
# .env.staging (for staging environment)
# .env.production (for production environment)

# Example environment indicator
ENVIRONMENT=development
BUILD_VERSION=2.1.0-SNAPSHOT
BUILD_TIMESTAMP=2025-01-15T10:30:00Z
GIT_COMMIT_HASH=abc123def456